<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN"
"http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">

<mapper namespace="com.ly.sys.core.user.dao.OperatorDao">
	<!-- 
		<cache type="org.mybatis.caches.ehcache.LoggingEhcache" > 
			<property name="timeToIdleSeconds" value="3600"/>
			<property name="timeToLiveSeconds" value="3600"/>
			<property name="maxEntriesLocalHeap" value="1000"/>
			<property name="maxEntriesLocalDisk" value="100000"/>
			<property name="memoryStoreEvictionPolicy" value="LRU"/>
		</cache>
		-->
	<resultMap id="operatorResult" type="Operator">
		<id property="id" column="id" javaType="Long" />
		<result property="source" column="source" javaType="String" />
		<result property="username" column="username" javaType="String" />
		<result property="email" column="email" javaType="String" />
		<result property="mobile" column="mobile" javaType="String" />
		<result property="password" column="password" javaType="String" />
		<result property="status" column="status" javaType="Integer" />
		<result property="isAdmin" column="is_admin" javaType="Integer" />
		<result property="deleted" column="deleted" javaType="String" />
		<result property="createDate" column="create_date" javaType="Date" />
		
	</resultMap>


	<sql id="queryOperatorSql">
		<where>
		<![CDATA[
			1=1
		]]>
			<if test="id!=null">
			<![CDATA[
				and T.id=#{id}
			]]>
			</if>
			<if test="source!=null">
			<![CDATA[
				and T.source=#{source}
			]]>
			</if>
			<if test="username!=null">
			<![CDATA[
				and T.username=#{username}
			]]>
			</if>
			<if test="email!=null">
			<![CDATA[
				and T.email=#{email}
			]]>
			</if>
			<if test="mobile!=null">
			<![CDATA[
				and T.mobile=#{mobile}
			]]>
			</if>
			<if test="password!=null">
			<![CDATA[
				and T.password=#{password}
			]]>
			</if>
			<if test="status!=null">
			<![CDATA[
				and T.status=#{status}
			]]>
			</if>
			<if test="isAdmin!=null">
			<![CDATA[
				and T.is_admin=#{isAdmin}
			]]>
			</if>
			<if test="deleted!=null">
			<![CDATA[
				and T.deleted=#{deleted}
			]]>
			</if>
			<if test="createDate!=null">
			<![CDATA[
				and T.create_date=#{createDate}
			]]>
			</if>
			<if test="username_like!=null">
			<![CDATA[
				and T.username like "%${username_like}%"
			]]>
			</if>
			<if test="status_eq!=null">
			<![CDATA[
				and T.status = #{status_eq}
			]]>
			</if>
			<if test="createDate_gte!=null">
			<![CDATA[
				and T.create_date >= #{createDate_gte}
			]]>
			</if>
			<if test="createDate_lte!=null">
			<![CDATA[
				and T.create_date <= #{createDate_lte}
			]]>
			</if>
		</where>
	</sql>

	<select id="findById" resultMap="operatorResult" parameterType="long">
	<![CDATA[
		SELECT T.* FROM sys_operator T  where T.id=#{id}
	]]>
	</select>
	
	<select id="findPageList" resultMap="operatorResult"
		parameterType="map">
	<![CDATA[
		SELECT T.* FROM sys_operator T 
	]]>
		<include refid="queryOperatorSql" />

	</select>

	<select id="findCount" resultType="Integer" parameterType="map">
	<![CDATA[
		SELECT COUNT(1) FROM sys_operator T
	]]>
		<include refid="queryOperatorSql" />
	</select>

	<insert id="insert" parameterType="Operator">
	<![CDATA[
		INSERT INTO sys_operator(
											id,
											source,
											username,
											email,
											mobile,
											password,
											status,
											is_admin,
											deleted,
											create_date
								)VALUES(
							#{id},
											#{source},
											#{username},
											#{email},
											#{mobile},
											#{password},
											#{status},
											#{isAdmin},
											#{deleted},
											#{createDate}
								)
	]]>
		<selectKey resultType="long" keyProperty="id">
			SELECT
			LAST_INSERT_ID() AS ID
		</selectKey>
	</insert>

	<update id="update" parameterType="Operator">
	<![CDATA[
		UPDATE sys_operator SET
													source=#{source},
															username=#{username},
															email=#{email},
															mobile=#{mobile},
															password=#{password},
															status=#{status},
															is_admin=#{isAdmin},
															deleted=#{deleted},
															create_date=#{createDate}
									WHERE id=#{id}
	]]>
	</update>

	<delete id="delete" parameterType="long">
	<![CDATA[
		DELETE FROM sys_operator WHERE id=#{id}
	]]>
	</delete>
	<select id="findByUsername" resultType="Operator">
		select *
		from sys_operator
		where username=#{username} and status = 1
	</select>
	<select id="findByEmail" resultType="Operator">
		select *
		from sys_operator
		where email=#{email}
	</select>
	<select id="findByMobilePhoneNumber" resultType="Operator">
		select *
		from
		sys_operator
		where mobile=#{mobilePhoneNumber}
	</select>
	<select id="findSysById" resultType="Operator">
    select *
    from
    sys_operator
    where id=#{id} and source=#{source}
	</select>
	<select id="getAllOperators" resultType="Operator">
    select *
    from sys_operator
	</select>
</mapper>
